# 化学問題の意味検索アプリ（ローカルWeb）

化学の問題文を「意味を表す数字の列」に変換して保持し、検索文と近い順に上位10件を表示するシンプルなローカルWebアプリです。  
最小構成で動作することを優先し、ダミーデータ（30〜60問の範囲）を同梱しています。

## できること
- 起動時に全問題文をベクトル化してメモリに保持
- 検索文も同じ方法でベクトル化
- コサイン類似度で近い順に上位10件を返す
- 検索結果に `title` と `tags` を表示
- 結果をクリックして `/problems/<id>` の詳細ページへ遷移
- 詳細ページで `title / statement / choices` を表示
- 答えはデフォルト非表示、「答えを表示」⇄「答えを隠す」ボタンでトグル表示

## 使い方（Windows / WSL）

> 事前に Python 3.10+ を用意してください。追加ライブラリは不要です。

```bash
# 1) WSLのターミナルを開いて、リポジトリへ移動
cd /workspace/hello-world

# 2) アプリ起動
python3 app.py
```

起動後、Windows側ブラウザで以下へアクセス:

```
http://localhost:8000
```

## 操作手順（検索→詳細→答え表示）
1. トップページで検索語（例: `電池`, `気体`, `平衡`）を入力。
2. 類似度順に表示された問題タイトルをクリック。
3. 詳細ページで問題文・選択肢を確認。
4. 「答えを表示」ボタンを押して答えを表示。
5. もう一度押すと「答えを隠す」から戻って非表示に。

## データスキーマ
`data/problems.json` の各問題は以下の項目を持ちます。

- `id` (URLで使う英数字+アンダースコア)
- `title`
- `statement`
- `choices`（任意）
- `answer`（任意）
- `tags`（配列）
- `concepts`（配列）
- `source`（現状は `dummy`）

## データ
- 問題数は36問。
- 単元は気体 / 平衡 / 酸塩基 / 熱化学 / 電池 / 有機をバランス良く混在。
- `choices` や `answer` が欠けていても、画面が落ちないように実装。

## 仕組み（超簡易）
- 文字2-gramを作成し、固定長ベクトルにハッシュで割り当てます。
- ベクトルを正規化し、コサイン類似度で近い順に並べます。

## 手動テストチェックリスト（軽量）
- [ ] `python3 app.py` でサーバが起動する
- [ ] `/` で検索ページが開く
- [ ] 検索入力で結果が最大10件表示される
- [ ] 結果クリックで `/problems/<id>` に移動できる
- [ ] 詳細ページで `title / statement` が表示される
- [ ] `choices` がある問題で選択肢が表示される
- [ ] 「答えを表示」クリックで答えが表示される
- [ ] 「答えを隠す」クリックで答えが非表示に戻る

## 補足
- 日本語コメント多めで、最小構成です。
- まず「動くもの」を優先した実装です。

## コンフリクトを起こしにくくする運用メモ
この機能を `main` の最新に追従しながら取り込む場合は、以下の順がおすすめです。

1. `main` から新しい作業ブランチを作る。
2. このアプリ変更は「データ更新」と「画面/API変更」を分けてコミットする。
3. PR作成前に `main` を取り込み（rebase または merge）、`README.md / app.py / data/problems.json / static/index.html` を優先的に確認する。
4. 競合時は「main側の既存変更を残す」ことを先に決め、必要な機能（問題詳細ページ・答えトグル・拡張スキーマ）だけを最小差分で再適用する。

この手順にすると、同じ4ファイルでの大きな競合を減らしやすくなります。
